machine:
  java:
    version: openjdk7
  ruby:
   version: 2.1.1
  environment:
    GRADLE_OPTS: '-Dorg.gradle.jvmargs="-Xmx2048m -XX:+HeapDumpOnOutOfMemoryError"'

dependencies:
  pre:
    - echo y | android update sdk --no-ui --all --filter platform-tools,tools,android-23,build-tools-23.0.1,extra-android-m2repository,extra-android-support,extra-google-m2repository

    - chmod +x gradlew
    - chmod +x circle-ci -R

  cache_directories:
    - ~/.android
    - ~/.gradle
    - ~/.rvm/gems/ruby-2.1.1
  override:
    - ./gradlew dependencies

test:
  override:
    - ./gradlew test -PdisablePreDex --stacktrace;

general:
  artifacts:
    - "**/**/build/outputs/apk"
    - "**/**/build/outputs/mapping/**/**/mapping.txt"
